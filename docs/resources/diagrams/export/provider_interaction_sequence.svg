<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1463px" preserveAspectRatio="none" style="width:1453px;height:1463px;background:#FFFFFF;" version="1.1" viewBox="0 0 1453 1463" width="1453px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="353.5469" style="stroke:#000000;stroke-width:1;" width="1421.52" x="15" y="789.3828"/><rect fill="#FFFFFF" height="222.0156" style="stroke:#000000;stroke-width:1;" width="565.3774" x="607.2266" y="884.7813"/><rect fill="#FFFFFF" height="43.9375" style="stroke:none;stroke-width:1;" width="565.3774" x="607.2266" y="931.0469"/><rect fill="#FFFFFF" height="43.9375" style="stroke:none;stroke-width:1;" width="565.3774" x="607.2266" y="974.9844"/><rect fill="#FFFFFF" height="43.9375" style="stroke:none;stroke-width:1;" width="565.3774" x="607.2266" y="1018.9219"/><rect fill="#FFFFFF" height="43.9375" style="stroke:none;stroke-width:1;" width="565.3774" x="607.2266" y="1062.8594"/><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="1359.3984" width="8" x="58.2651" y="52.5938"/><line style="stroke:#000000;stroke-width:1;" x1="62" x2="62" y1="52.5938" y2="1411.9922"/></g><g><title>ProviderRegistry</title><rect fill="#000000" fill-opacity="0.00000" height="1359.3984" width="8" x="470.1958" y="52.5938"/><line style="stroke:#000000;stroke-width:1;" x1="474.1279" x2="474.1279" y1="52.5938" y2="1411.9922"/></g><g><title>YourProvider</title><rect fill="#000000" fill-opacity="0.00000" height="1359.3984" width="8" x="675.1968" y="52.5938"/><line style="stroke:#000000;stroke-width:1;" x1="678.2266" x2="678.2266" y1="52.5938" y2="1411.9922"/></g><g><title>EventPublisher</title><rect fill="#000000" fill-opacity="0.00000" height="1359.3984" width="8" x="1089.292" y="52.5938"/><line style="stroke:#000000;stroke-width:1;" x1="1092.98" x2="1092.98" y1="52.5938" y2="1411.9922"/></g><g><title>ToolLifecycle</title><rect fill="#000000" fill-opacity="0.00000" height="1359.3984" width="8" x="1231.0972" y="52.5938"/><line style="stroke:#000000;stroke-width:1;" x1="1234.604" x2="1234.604" y1="52.5938" y2="1411.9922"/></g><g><title>External API</title><rect fill="#000000" fill-opacity="0.00000" height="1359.3984" width="8" x="1363.0552" y="52.5938"/><line style="stroke:#000000;stroke-width:1;" x1="1366.5903" x2="1366.5903" y1="52.5938" y2="1411.9922"/></g><g class="participant participant-head" data-participant="C"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.5303" x="35" y="21.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="42" y="41.292">Client</text></g><g class="participant participant-tail" data-participant="C"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.5303" x="35" y="1410.9922"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="42" y="1430.9873">Client</text></g><g class="participant participant-head" data-participant="R"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="130.1357" x="409.1279" y="21.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="116.1357" x="416.1279" y="41.292">ProviderRegistry</text></g><g class="participant participant-tail" data-participant="R"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="130.1357" x="409.1279" y="1410.9922"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="116.1357" x="416.1279" y="1430.9873">ProviderRegistry</text></g><g class="participant participant-head" data-participant="P"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="103.9404" x="627.2266" y="21.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="89.9404" x="634.2266" y="41.292">YourProvider</text></g><g class="participant participant-tail" data-participant="P"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="103.9404" x="627.2266" y="1410.9922"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="89.9404" x="634.2266" y="1430.9873">YourProvider</text></g><g class="participant participant-head" data-participant="E"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="118.624" x="1033.98" y="21.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104.624" x="1040.98" y="41.292">EventPublisher</text></g><g class="participant participant-tail" data-participant="E"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="118.624" x="1033.98" y="1410.9922"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104.624" x="1040.98" y="1430.9873">EventPublisher</text></g><g class="participant participant-head" data-participant="T"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="104.9863" x="1182.604" y="5"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="90.9863" x="1189.604" y="24.9951">ToolLifecycle</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="74.5391" x="1197.8276" y="41.292">Subscriber</text></g><g class="participant participant-tail" data-participant="T"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="104.9863" x="1182.604" y="1410.9922"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="90.9863" x="1189.604" y="1430.9873">ToolLifecycle</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="74.5391" x="1197.8276" y="1447.2842">Subscriber</text></g><g class="participant participant-head" data-participant="API"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="98.9297" x="1317.5903" y="21.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="84.9297" x="1324.5903" y="41.292">External API</text></g><g class="participant participant-tail" data-participant="API"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="98.9297" x="1317.5903" y="1410.9922"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="84.9297" x="1324.5903" y="1430.9873">External API</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1441.52" x="5" y="83.1602"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1446.52" y1="83.1602" y2="83.1602"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1446.52" y1="86.1602" y2="86.1602"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="175.9668" x="637.7766" y="72.5938"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="157.4409" x="643.7766" y="88.6606">Provider Registration</text><g class="message" data-participant-1="C" data-participant-2="R"><polygon fill="#000000" points="462.1958,122.8594,472.1958,126.8594,462.1958,130.8594,466.1958,126.8594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="468.1958" y1="126.8594" y2="126.8594"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="387.9307" x="69.2651" y="121.7935">@ProviderRegistry.register(ELLMProvider.YOUR_PROVIDER)</text></g><g class="message" data-participant-1="R" data-participant-2="R"><line style="stroke:#000000;stroke-width:1;" x1="474.1958" x2="516.1958" y1="155.9922" y2="155.9922"/><line style="stroke:#000000;stroke-width:1;" x1="516.1958" x2="516.1958" y1="155.9922" y2="168.9922"/><line style="stroke:#000000;stroke-width:1;" x1="475.1958" x2="516.1958" y1="168.9922" y2="168.9922"/><polygon fill="#000000" points="485.1958,164.9922,475.1958,168.9922,485.1958,172.9922,481.1958,168.9922" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="191.001" x="481.1958" y="150.9263">Store provider class mapping</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1441.52" x="5" y="197.5586"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1446.52" y1="197.5586" y2="197.5586"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1446.52" y1="200.5586" y2="200.5586"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="177.4839" x="637.0181" y="186.9922"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="158.958" x="643.0181" y="203.0591">Provider Initialization</text><g class="message" data-participant-1="C" data-participant-2="R"><polygon fill="#000000" points="462.1958,237.2578,472.1958,241.2578,462.1958,245.2578,466.1958,241.2578" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="468.1958" y1="241.2578" y2="241.2578"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="294.8359" x="69.2651" y="236.1919">get_provider(ELLMProvider.YOUR_PROVIDER)</text></g><g class="message" data-participant-1="R" data-participant-2="P"><polygon fill="#000000" points="667.1968,266.3906,677.1968,270.3906,667.1968,274.3906,671.1968,270.3906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="474.1958" x2="673.1968" y1="270.3906" y2="270.3906"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100.7563" x="481.1958" y="265.3247">create instance</text></g><g class="message" data-participant-1="P" data-participant-2="P"><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="721.1968" y1="299.5234" y2="299.5234"/><line style="stroke:#000000;stroke-width:1;" x1="721.1968" x2="721.1968" y1="299.5234" y2="312.5234"/><line style="stroke:#000000;stroke-width:1;" x1="680.1968" x2="721.1968" y1="312.5234" y2="312.5234"/><polygon fill="#000000" points="690.1968,308.5234,680.1968,312.5234,690.1968,316.5234,686.1968,312.5234" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="64.3271" x="686.1968" y="294.4575">initialize()</text></g><g class="message" data-participant-1="P" data-participant-2="API"><polygon fill="#000000" points="1355.0552,337.6563,1365.0552,341.6563,1355.0552,345.6563,1359.0552,341.6563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="1361.0552" y1="341.6563" y2="341.6563"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="134.0815" x="686.1968" y="336.5903">establish connection</text></g><g class="message" data-participant-1="P" data-participant-2="R"><polygon fill="#000000" points="485.1958,366.7891,475.1958,370.7891,485.1958,374.7891,481.1958,370.7891" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="479.1958" x2="678.1968" y1="370.7891" y2="370.7891"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="158.0503" x="491.1958" y="365.7231">return provider instance</text></g><g class="message" data-participant-1="R" data-participant-2="C"><polygon fill="#000000" points="73.2651,395.9219,63.2651,399.9219,73.2651,403.9219,69.2651,399.9219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="67.2651" x2="473.1958" y1="399.9219" y2="399.9219"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="98.8457" x="79.2651" y="394.856">return provider</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1441.52" x="5" y="428.4883"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1446.52" y1="428.4883" y2="428.4883"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1446.52" y1="431.4883" y2="431.4883"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="196.9014" x="627.3093" y="417.9219"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.3755" x="633.3093" y="433.9888">Chat Request with Tools</text><g class="message" data-participant-1="C" data-participant-2="P"><polygon fill="#000000" points="667.1968,468.1875,677.1968,472.1875,667.1968,476.1875,671.1968,472.1875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="673.1968" y1="472.1875" y2="472.1875"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="268.3853" x="69.2651" y="467.1216">prepare_chat_payload(messages, model)</text></g><g class="message" data-participant-1="P" data-participant-2="P"><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="721.1968" y1="501.3203" y2="501.3203"/><line style="stroke:#000000;stroke-width:1;" x1="721.1968" x2="721.1968" y1="501.3203" y2="514.3203"/><line style="stroke:#000000;stroke-width:1;" x1="680.1968" x2="721.1968" y1="514.3203" y2="514.3203"/><polygon fill="#000000" points="690.1968,510.3203,680.1968,514.3203,690.1968,518.3203,686.1968,514.3203" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="122.916" x="686.1968" y="496.2544">build base payload</text></g><g class="message" data-participant-1="C" data-participant-2="P"><polygon fill="#000000" points="667.1968,539.4531,677.1968,543.4531,667.1968,547.4531,671.1968,543.4531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="673.1968" y1="543.4531" y2="543.4531"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="201.9443" x="69.2651" y="538.3872">add_tools_to_payload(payload)</text></g><g class="message" data-participant-1="P" data-participant-2="T"><polygon fill="#000000" points="1223.0972,568.5859,1233.0972,572.5859,1223.0972,576.5859,1227.0972,572.5859" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="1229.0972" y1="572.5859" y2="572.5859"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="128.1973" x="686.1968" y="567.52">get_enabled_tools()</text></g><g class="message" data-participant-1="T" data-participant-2="P"><polygon fill="#000000" points="690.1968,597.7188,680.1968,601.7188,690.1968,605.7188,686.1968,601.7188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="684.1968" x2="1234.0972" y1="601.7188" y2="601.7188"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="138.5947" x="696.1968" y="596.6528">return available tools</text></g><g class="message" data-participant-1="P" data-participant-2="P"><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="721.1968" y1="630.8516" y2="630.8516"/><line style="stroke:#000000;stroke-width:1;" x1="721.1968" x2="721.1968" y1="630.8516" y2="643.8516"/><line style="stroke:#000000;stroke-width:1;" x1="680.1968" x2="721.1968" y1="643.8516" y2="643.8516"/><polygon fill="#000000" points="690.1968,639.8516,680.1968,643.8516,690.1968,647.8516,686.1968,643.8516" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="207.3145" x="686.1968" y="625.7856">mcp_to_provider_tool() for each</text></g><g class="message" data-participant-1="P" data-participant-2="C"><polygon fill="#000000" points="73.2651,668.9844,63.2651,672.9844,73.2651,676.9844,69.2651,672.9844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="67.2651" x2="678.1968" y1="672.9844" y2="672.9844"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="163.3252" x="79.2651" y="667.9185">return payload with tools</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1441.52" x="5" y="701.5508"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1446.52" y1="701.5508" y2="701.5508"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1446.52" y1="704.5508" y2="704.5508"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="169.8032" x="640.8584" y="690.9844"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="151.2773" x="646.8584" y="707.0513">Streaming Response</text><g class="message" data-participant-1="C" data-participant-2="P"><polygon fill="#000000" points="667.1968,741.25,677.1968,745.25,667.1968,749.25,671.1968,745.25" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="673.1968" y1="745.25" y2="745.25"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="208.4634" x="69.2651" y="740.1841">stream_chat_response(payload)</text></g><g class="message" data-participant-1="P" data-participant-2="API"><polygon fill="#000000" points="1355.0552,770.3828,1365.0552,774.3828,1355.0552,778.3828,1359.0552,774.3828" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="1361.0552" y1="774.3828" y2="774.3828"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="85.0967" x="686.1968" y="769.3169">send request</text></g><path d="M15,789.3828 L91.624,789.3828 L91.624,796.5156 L81.624,806.5156 L15,806.5156 L15,789.3828" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="353.5469" style="stroke:#000000;stroke-width:1;" width="1421.52" x="15" y="789.3828"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="30" y="802.4497">loop</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="102.0454" x="106.624" y="801.5933">[for each chunk]</text><g class="message" data-participant-1="API" data-participant-2="P"><polygon fill="#000000" points="690.1968,823.6484,680.1968,827.6484,690.1968,831.6484,686.1968,827.6484" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="684.1968" x2="1366.0552" y1="827.6484" y2="827.6484"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="102.8574" x="696.1968" y="822.5825">response chunk</text></g><g class="message" data-participant-1="P" data-participant-2="P"><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="721.1968" y1="856.7813" y2="856.7813"/><line style="stroke:#000000;stroke-width:1;" x1="721.1968" x2="721.1968" y1="856.7813" y2="869.7813"/><line style="stroke:#000000;stroke-width:1;" x1="680.1968" x2="721.1968" y1="869.7813" y2="869.7813"/><polygon fill="#000000" points="690.1968,865.7813,680.1968,869.7813,690.1968,873.7813,686.1968,869.7813" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="222.7012" x="686.1968" y="851.7153">_parse_and_publish_chunk(chunk)</text></g><path d="M607.2266,884.7813 L671.6694,884.7813 L671.6694,891.9141 L661.6694,901.9141 L607.2266,901.9141 L607.2266,884.7813" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="222.0156" style="stroke:#000000;stroke-width:1;" width="565.3774" x="607.2266" y="884.7813"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="622.2266" y="897.8481">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="155.4985" x="686.6694" y="896.9917">[chunk contains content]</text><g class="message" data-participant-1="P" data-participant-2="E"><polygon fill="#000000" points="1081.292,919.0469,1091.292,923.0469,1081.292,927.0469,1085.292,923.0469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="1087.292" y1="923.0469" y2="923.0469"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="274.5615" x="686.1968" y="917.981">publish(EventType.CONTENT, content=...)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="607.2266" x2="1172.604" y1="932.0469" y2="932.0469"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="157.2388" x="612.2266" y="942.2573">[chunk contains tool call]</text><g class="message" data-participant-1="P" data-participant-2="E"><polygon fill="#000000" points="1081.292,962.9844,1091.292,966.9844,1081.292,970.9844,1085.292,966.9844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="1087.292" y1="966.9844" y2="966.9844"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="250.1104" x="686.1968" y="961.9185">publish(EventType.ROLE, tool_call=...)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="607.2266" x2="1172.604" y1="975.9844" y2="975.9844"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="157.2388" x="612.2266" y="986.1948">[chunk contains tool call]</text><g class="message" data-participant-1="P" data-participant-2="E"><polygon fill="#000000" points="1081.292,1006.9219,1091.292,1010.9219,1081.292,1014.9219,1085.292,1010.9219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="1087.292" y1="1010.9219" y2="1010.9219"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="260.3364" x="686.1968" y="1005.856">publish(EventType.USAGE, tool_call=...)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="607.2266" x2="1172.604" y1="1019.9219" y2="1019.9219"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="157.2388" x="612.2266" y="1030.1323">[chunk contains tool call]</text><g class="message" data-participant-1="P" data-participant-2="E"><polygon fill="#000000" points="1081.292,1050.8594,1091.292,1054.8594,1081.292,1058.8594,1085.292,1054.8594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="1087.292" y1="1054.8594" y2="1054.8594"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="390.0952" x="686.1968" y="1049.7935">publish(EventType.LLM_TOOL_CALL_REQUEST, tool_call=...)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="607.2266" x2="1172.604" y1="1063.8594" y2="1063.8594"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="130.0986" x="612.2266" y="1074.0698">[chunk signals error]</text><g class="message" data-participant-1="P" data-participant-2="E"><polygon fill="#000000" points="1081.292,1094.7969,1091.292,1098.7969,1081.292,1102.7969,1085.292,1098.7969" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="1087.292" y1="1098.7969" y2="1098.7969"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="239.4653" x="686.1968" y="1093.731">publish(EventType.ERROR, error=...)</text></g><g class="message" data-participant-1="P" data-participant-2="C"><polygon fill="#000000" points="73.2651,1130.9297,63.2651,1134.9297,73.2651,1138.9297,69.2651,1134.9297" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="67.2651" x2="678.1968" y1="1134.9297" y2="1134.9297"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="74.6929" x="79.2651" y="1129.8638">yield chunk</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1441.52" x="5" y="1170.4961"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1446.52" y1="1170.4961" y2="1170.4961"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1446.52" y1="1173.4961" y2="1173.4961"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="165.874" x="642.823" y="1159.9297"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="147.3481" x="648.823" y="1175.9966">Tool Call Processing</text><path d="M16,1198.0625 L16,1253.0625 L1412,1253.0625 L1412,1208.0625 L1402,1198.0625 L16,1198.0625" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1402,1198.0625 L1402,1208.0625 L1412,1208.0625 L1402,1198.0625" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="721.627" x="310.2163" y="1215.1294">See developer documentation for full tool call processing which includes a custom tool call chaining sequence.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="733.1987" x="310.2163" y="1230.2622">Tool chaining involves multiple event subscribers, deduplication, execution, result collection, and chaining logic.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="799.0874" x="310.2163" y="1245.395">For the complete sequence, see the developer documentation and the diagram 'tool_chaining_events_sequence_v2.puml'.</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1441.52" x="5" y="1279.0273"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1446.52" y1="1279.0273" y2="1279.0273"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1446.52" y1="1282.0273" y2="1282.0273"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="77.9272" x="686.7964" y="1268.4609"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59.4014" x="692.7964" y="1284.5278">Cleanup</text><g class="message" data-participant-1="C" data-participant-2="P"><polygon fill="#000000" points="667.1968,1318.7266,677.1968,1322.7266,667.1968,1326.7266,671.1968,1322.7266" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="673.1968" y1="1322.7266" y2="1322.7266"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="43.6274" x="69.2651" y="1317.6606">close()</text></g><g class="message" data-participant-1="P" data-participant-2="API"><polygon fill="#000000" points="1355.0552,1347.8594,1365.0552,1351.8594,1355.0552,1355.8594,1359.0552,1351.8594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="1361.0552" y1="1351.8594" y2="1351.8594"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="116.0161" x="686.1968" y="1346.7935">close connections</text></g><g class="message" data-participant-1="P" data-participant-2="P"><line style="stroke:#000000;stroke-width:1;" x1="679.1968" x2="721.1968" y1="1380.9922" y2="1380.9922"/><line style="stroke:#000000;stroke-width:1;" x1="721.1968" x2="721.1968" y1="1380.9922" y2="1393.9922"/><line style="stroke:#000000;stroke-width:1;" x1="680.1968" x2="721.1968" y1="1393.9922" y2="1393.9922"/><polygon fill="#000000" points="690.1968,1389.9922,680.1968,1393.9922,690.1968,1397.9922,686.1968,1393.9922" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="119.1582" x="686.1968" y="1375.9263">cleanup resources</text></g><!--SRC=[hLLDZzis4BthLqnpYGquEkIuW8ikLBLOm8bTMLiWG061fcPj8XJ9yCE9- -ix92MjlK6pbrmaWVFuPkRDXtxn9nmGZ6H25OLXrWik35CUtbHIeF9lW3ceRYqxgy-YHzlWKJXlBmdJt68-wM0dNBBlRktrcSXtuI25Eus8-XRHQYqtuWdvXKlyH-t3mN4h3YEuVK7tpQDLJCBzxY7PwLqKwpLCCS0OBFD2ArYlYmhU_GhD7VpsCflIfW-qYtgp-J1Poq_RnwRRDTk_7twlcsNHZDVtNblIR_B29NCE1cQCKCVR01wKy899yUzt8HpHTnF3wqvtTy0jCeyWbFDCSInsuxcONE1YcGz9XZj0WYMXWMkba4V_sKpEBVfWrNC6CsboLdq7I4bL9-P9qI-1gE6hy2U8rN9pKXIBiKWLmeuJj3Fi8ZNh5mCwnuxeLZ3e7kLoZlmGXEpXm1nfcR4p4UlxpaTsUiv4utiaQBE6g2XD7D6aG3ioZ1cmCnCo8Y01Pjy3DubwJ31TNopXILj0nayPToL4TftJpanHahsdeWnKTTB56QqeaoirNB9cCUneVv54AfL3rPEZ96mXjJPp6C1FGNqk8EBcl4P7asdAY6Io3Zkc-ixa4UiIP96UIq8owVEjs1AUXj-b3vf9Cev4DHKntrwaQMql1ijg-x6jFxQh2Rukop8IefpYU6QCuW1dKhx2sMmtzIgXkuZ-6PIF-_i_VpOd3MRNRhURhhhVRBgc_kknthS_zk74aPQI0xHMsrVewwRPDgiCdQbKFvML6l0Ya8Oa5pjQOjl5kOEAlCT5mscyOWTIuobD2qAVQQ2hLLg6UqJeyOnI6phiDGy3USwxAFROKo2EMOeuxXFRrvEWzXEAoz2Z0mOyEA-7Ap2rDQqUWhhOkRGyoYB5DPyBTTRoJ9U78BqmD88OymOtBtLQ2JtsmKZ1Kqman3Va8NzIeuVOi5hAlBrMGBtzJ2_rKV2o-8FIeFyPuGPoGVbFuQpe2vFf_nI8TCaksD6o0TxcgeuEkXIjwoQ-xlo-D66GRyjO1uXQvxKeaQbWhWUVI-rkjt4wkTh4puk8ZzSfNVfxalp_0G00]--></g></svg>